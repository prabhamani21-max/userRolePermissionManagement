<app-page-title
  title="Dashboard"
  titleLink="/userRolePermission/dashboard"
  [subtitle]="'User Management'"
/>
<div class="card">
  <div class="card-body">
    <div
      class="card-header d-flex align-items-right justify-content-between gap-2"
    >
      <h4 class="card-title flex-grow-1"></h4>
      <button *hasPermission="'UserManagement:Add'" class="btn btn-sm btn-soft-primary" (click)="onCreate()">
        <i class="bx bx-plus"></i> Add
      </button>
    </div>
    <div class="table-responsive">
      <table class="table table-hover table-centered">
        <thead class="table-light">
          <tr>
            <th class="text-muted py-1">Name</th>
            <th class="text-muted py-1">Email</th>
            <th class="text-muted py-1">Gender</th>
            <th class="text-muted py-1">DOB</th>
            <th class="text-muted py-1">Contact No</th>
            <th class="text-muted py-1">Role</th>
            <th class="text-muted py-1">Action</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let user of users; trackBy: trackById">
            <td>
              <h5>{{ user.name }}</h5>
            </td>
            <td>{{ user.email }}</td>
            <td>
              {{
                user.gender === 1
                  ? "Male"
                  : user.gender === 0
                    ? "Female"
                    : "Other"
              }}
            </td>
            <td>{{ user.dob | date: "mediumDate" }}</td>
            <td>{{ user.contactNo }}</td>
            <td>{{ user.roleId | roleName: roles }}</td>

            <td>
              <button
                *hasPermission="'UserManagement:View'"
                class="btn btn-sm bg-transparent text-danger"
                (click)="onView(user)"
                title="View"
              >
                <i class="bx bx-show"></i>
              </button>
              <button
                *hasPermission="'UserManagement:Update'"
                class="btn btn-sm bg-transparent text-secondary"
                (click)="onEdit(user)"
                title="Edit"
              >
                <i class="bx bx-edit"></i>
              </button>
              <button
                *hasPermission="'UserManagement:Delete'"
                class="btn btn-sm bg-transparent text-danger"
                (click)="onDelete(user.id)"
                title="Delete"
              >
                <i class="bx bx-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>


<!-- Pagination Controls -->
<div class="d-flex justify-content-between align-items-center mt-3" *ngIf="totalCount > 0">
  <!-- Page Size Selector and Entry Info -->
  <div class="d-flex align-items-center gap-2">
    <label class="form-label mb-0" style="margin-left: 0.5cm;">Show:</label>
    <select
      class="form-select form-select-sm"
      style="width: auto;"
      [value]="pageSize"
      (change)="onPageSizeChange($any($event.target).value)"
    >
      <option *ngFor="let size of pageSizeOptions" [value]="size">
        {{ size }}
      </option>
    </select>
    <span class="text-muted">entries</span>
  </div>

  <!-- Entry Counter -->
  <div class="text-muted">
    Showing {{ ((currentPage - 1) * pageSize) + 1 }} to {{ getEndIndex() }} of {{ totalCount }} entries
  </div>

  <!-- Pagination Controls -->
  <div *ngIf="totalCount > pageSize">
    <ngb-pagination
      [collectionSize]="totalCount"
      [(page)]="currentPage"
      [pageSize]="pageSize"
      [maxSize]="3"
      [rotate]="true"
      [boundaryLinks]="false"
      [directionLinks]="true"
      (pageChange)="onPageChange($event)"
      class="pagination pagination-rounded mb-0"
    >
      <ng-template ngbPaginationPrevious><i class="bx bx-left-arrow-alt"></i></ng-template>
      <ng-template ngbPaginationNext><i class="bx bx-right-arrow-alt"></i></ng-template>
    </ngb-pagination>
  </div>
</div>
</div>




